# configs/pipeline_span_id.yaml

project_root: /data/sundeep/Fandom_SI
domain: money-heist
suffix: _paragraph_nopunct

paths:
  data_dir: "{project_root}/data/span_identification/{domain}"
  logs_dir: "{project_root}/data/logs/span_identification/{domain}"
  exp_root: "{project_root}/experiments/span_id/{domain}"
  run_name: "bert_bilou{suffix}"
  ckpt_dir: "{exp_root}/{run_name}"
  results_dir: "{project_root}/results"
  results_csv: "{results_dir}/span_identifier_metrics.csv"
  preds_test: "{results_dir}/{domain}_spanid_preds_test{suffix}.jsonl"

# list the directories that must exist (runner creates them before running)
ensure_dirs:
  - "{paths.data_dir}"
  - "{paths.logs_dir}"
  - "{paths.ckpt_dir}"
  - "{paths.results_dir}"

prep:
  script: "{project_root}/scripts/Span_Identification/14_prepare_span_id_dataset_paragraph_nopunct.py"
  config: "{project_root}/configs/span_id_prep.yaml"
  params:
    domain: "{domain}"
    suffix: "{suffix}"
    out_dir: "{paths.data_dir}"
    remove_punct: true
    require_spans: true
    para_sep: "\n\n"

train:
  script: "{project_root}/scripts/Span_Identification/15_train_span_identifier.py"
  config: "{project_root}/configs/span_identi.yaml"
  params:
    domain: "{domain}"
    suffix: "{suffix}"
    data_dir: "{paths.data_dir}"
    out_dir: "{paths.ckpt_dir}"

eval:
  script: "{project_root}/scripts/Span_Identification/16_eval_span_identifier.py"
  params:
    domain: "{domain}"
    suffix: "{suffix}"
    data_dir: "{paths.data_dir}"
    ckpt: "{paths.ckpt_dir}"
    split: test
    max_length: 512
    iou_threshold: 0.5
    span_recall_k: 5
    results_csv: "{paths.results_csv}"
    save_preds: "{paths.preds_test}"
